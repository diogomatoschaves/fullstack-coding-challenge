(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{135:function(e,t,a){e.exports=a.p+"static/media/unbabel-logo.6cbce8d6.svg"},136:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),s=a(18),i=a.n(s),o=(a(83),a(8)),c=a.n(o),u=a(13),l=a(15),d=a(14),h=a(22),p=a(23),m=a(29),g=a(24),f=a(28),b=a(17),x=(a(87),a(141)),w=a(142),y=a(137),v=a(138),j=a(143),k=a(67),S=a(134),O=function(){var e=Object(u.a)(c.a.mark(function e(){var t,a,n;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=new Headers,a="".concat("https://unbabel-challenge.herokuapp.com","/get_jobs"),e.next=4,fetch(a,{method:"get",headers:t});case 4:if(!((n=e.sent).status>=400)){e.next=9;break}throw new Error("Error fetching jobs");case 9:return e.next=11,n.json();case 11:return e.abrupt("return",e.sent);case 12:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),T=function(){var e=Object(u.a)(c.a.mark(function e(t){var a,n,r;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=new Headers,n="".concat("https://unbabel-challenge.herokuapp.com","/check_status?uid=").concat(t.uid,"&id=").concat(t.id),e.next=4,fetch(n,{method:"get",headers:a});case 4:if(!((r=e.sent).status>=400)){e.next=9;break}throw new Error("Error checking job status");case 9:return e.next=11,r.json();case 11:return e.abrupt("return",e.sent);case 12:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),E=function(){var e=Object(u.a)(c.a.mark(function e(t){var a,n,r,s,i;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.jobId,n=t.id,r="".concat("https://unbabel-challenge.herokuapp.com","/check_confirmation?jobId=").concat(a,"&id=").concat(n),s=new Headers,e.next=5,fetch(r,{method:"get",headers:s});case 5:if(!((i=e.sent).status>=400)){e.next=10;break}throw new Error("Error fetching result");case 10:return e.next=12,i.json();case 12:return e.abrupt("return",e.sent);case 13:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),L=function(){var e=Object(u.a)(c.a.mark(function e(t){var a,n,r;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=new Headers,n="".concat("https://unbabel-challenge.herokuapp.com","/new_translation"),e.next=4,fetch(n,{method:"post",headers:a,body:t});case 4:if(!((r=e.sent).status>=400)){e.next=9;break}throw new Error("Error sending request");case 9:return e.next=11,r.json();case 11:return e.abrupt("return",e.sent);case 12:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),C=function(e){function t(e){var a;return Object(h.a)(this,t),(a=Object(m.a)(this,Object(g.a)(t).call(this,e))).handleChange=function(e){a.setState({text:e.target.value,buttonDisabled:!e.target.value})},a.state={message:"",text:"",sourceLang:{name:"English",key:"en"},targetLang:{name:"Spanish",key:"es"},buttonDisabled:!0},a.getResult=a.getResult.bind(Object(b.a)(Object(b.a)(a))),a.buttonSubmit=a.buttonSubmit.bind(Object(b.a)(Object(b.a)(a))),a}return Object(f.a)(t,e),Object(p.a)(t,[{key:"getResult",value:function(e){var t=this,a=e.jobId,n=e.id,r=e.text,s=e.timeStamp;console.log("this is being called");var i=this.props,o=i.addUid,l=i.addTranslation,d=i.updateTranslation,h=i.checkStatus,p=this.state,m=p.sourceLang,g=p.targetLang,f=0;l({id:n,jobId:a,originalText:r,sourceLang:m,targetLang:g,status:"requesting",timeStamp:s,translatedText:""}),this.setState({showMessage:!0,message:"Your request was sent!",bsStyle:"success"}),setTimeout(function(){t.setState({showMessage:!1})},3e3);var b=function(){var e=Object(u.a)(c.a.mark(function e(){var r,s;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return f++,e.prev=1,e.next=4,E({jobId:a,id:n});case 4:r=e.sent,console.log(r),r.uid?(o(n,r.uid),setTimeout(function(){h([{id:n,uid:r.uid}])},3e3)):r.status&&"failed"===r.status?(t.setState({showMessage:!0,message:"The request failed. Please try again",bsStyle:"danger"}),setTimeout(function(){t.setState({showMessage:!1})},3e3),d(n,{status:"failed"})):(s=t.props.translations,Object.keys(s).includes(n)&&setTimeout(b,7-f>=2?1e3*(7-f):2e3)),e.next=13;break;case 9:e.prev=9,e.t0=e.catch(1),t.setState({showMessage:!0,message:"The request failed. Please try again",bsStyle:"danger"}),setTimeout(function(){t.setState({showMessage:!1})},3e3);case 13:case"end":return e.stop()}},e,this,[[1,9]])}));return function(){return e.apply(this,arguments)}}();setTimeout(b,7e3)}},{key:"buttonSubmit",value:function(){var e=Object(u.a)(c.a.mark(function e(){var t,a,n,r,s,i,o,u=this;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.state.text,a=this.state,n=a.sourceLang,r=a.targetLang,t){e.next=4;break}return e.abrupt("return",null);case 4:return this.setState({text:""}),s=(new Date).getTime(),i=JSON.stringify({text:t,sourceLang:n.key,targetLang:r.key,timeStamp:s}),e.prev=7,e.next=10,L(i);case 10:(o=e.sent)&&this.getResult({jobId:o.job_id,id:o.translation_job,text:t,timeStamp:s}),console.log("this too was called"),e.next=19;break;case 15:e.prev=15,e.t0=e.catch(7),this.setState({showMessage:!0,message:"There was an error processing your request. Make sure you are connected to the internet.",bsStyle:"danger"}),setTimeout(function(){u.setState({showMessage:!1})},3e3);case 19:case"end":return e.stop()}},e,this,[[7,15]])}));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this,t=this.state,a=t.text,n=t.message,s=t.showMessage,i=t.bsStyle,o=t.sourceLang,c=t.targetLang,u=t.buttonDisabled,l=this.props,d=l.sourceLangs,h=l.targetLangs;return r.a.createElement("div",{className:"flex-column",style:{width:"80%",maxWidth:"850px",justifyContent:"space-around"}},r.a.createElement("div",{className:"flex-row",style:{justifyContent:"flex-start",alignSelf:"flex-start"}},r.a.createElement("div",null,r.a.createElement("strong",null,"From:"),r.a.createElement(w.a,{title:o.name,id:"dropdown-basic",style:{marginLeft:"10px"}},d.map(function(t){return r.a.createElement(y.a,{onClick:function(){return e.setState({sourceLang:t})},key:t.key,eventKey:"1"},t.name)}))),r.a.createElement("div",{style:{paddingLeft:"20px"}},r.a.createElement("strong",null,"To:"),r.a.createElement(w.a,{style:{marginLeft:"10px"},title:c.name,id:"dropdown-basic"},h.map(function(t){return r.a.createElement(y.a,{onClick:function(){return e.setState({sourceLang:t})},key:t.key,eventKey:"1"},t.name)})))),r.a.createElement("div",{className:"flex-row",style:{width:"100%",justifyContent:"space-between",marginTop:"15px"}},r.a.createElement(v.a,{style:{width:"77%"}},r.a.createElement(j.a,{id:"input-textarea",value:a,onChange:this.handleChange,componentClass:"textarea",placeholder:"Insert your text here",style:{height:"150px"}})),r.a.createElement("div",{className:"flex-row",style:{width:"20%"}},r.a.createElement(k.a,{type:"button",id:"send-request",disabled:u,bsStyle:"primary",bsSize:"large",onClick:this.buttonSubmit},"Send Request"))),r.a.createElement(S.a,{className:"message-to-user flex-column",bsSize:"large",bsStyle:i,style:{top:s?"60px":"-200px"}},n))}}]),t}(n.Component);C.defaultProps={sourceLangs:[{name:"English",key:"en"}],targetLangs:[{name:"Spanish",key:"es"}]};var M=C,N=a(139),_=a(140),I=a(133),q=function(e){function t(){var e,a;Object(h.a)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(a=Object(m.a)(this,(e=Object(g.a)(t)).call.apply(e,[this].concat(r)))).deleteJob=function(e){var t=e.id,n=new Headers,r=a.props.deleteTranslation,s="".concat("https://unbabel-challenge.herokuapp.com","/delete_job?id=").concat(t);r({id:t}),fetch(s,{method:"get",headers:n}).then(function(e){return e.json()}).then(function(e){e.status})},a.getFormattedDate=function(e){var t=Date.now()-e,a=Math.floor(t/1e3/60/60/24);t-=1e3*a*60*60*24;var n=Math.floor(t/1e3/60/60);t-=1e3*n*60*60;var r=Math.floor(t/1e3/60);t-=1e3*r*60;var s=Math.floor(t/1e3);return a>=1?"".concat(a," ").concat(1===a?"day":"days"," ago"):n>=1?"".concat(n," ").concat(1===n?"hour":"hours"," ago"):r>=1?"".concat(r," ").concat(1===r?"minute":"minutes"," ago"):"".concat(s," ").concat(1===s?"second":"seconds"," ago")},a}return Object(f.a)(t,e),Object(p.a)(t,[{key:"render",value:function(){var e=this,t=this.props,a=t.translations,n=t.styleOptions,s=t.expandTranslation,i=t.checkStatus,o=a?Object.keys(a).map(function(e){return a[e]}).sort(function(e,t){return t.originalText.length-e.originalText.length}):[];return r.a.createElement("div",{className:"flex-row",style:{width:"80%",maxWidth:"850px",justifyContent:"space-around"}},r.a.createElement(N.a,{style:{width:"100%"}},o&&o.map(function(t){return r.a.createElement("div",{key:t.id,className:"flex-row translation-item-wrapper",style:{width:"100%",justifyContent:"space-between"}},r.a.createElement(S.a,{bsStyle:n[t.status],style:{cursor:"pointer",padding:0,width:"77%",border:t.expanded&&"2px solid rgb(180, 180, 180)"},className:"flex-column translation-item"},r.a.createElement("div",{onClick:function(){return s(t.id)},className:"flex-column",style:{width:"100%",padding:"20px"}},r.a.createElement("div",{className:"flex-row",style:{width:"100%",justifyContent:"space-between"}},r.a.createElement("div",{style:{width:"40%"},className:"message-header"},t.originalText),r.a.createElement("div",{style:{width:"25%",textAlign:"center"}},r.a.createElement("strong",null,"time: "),e.getFormattedDate(t.timeStamp)),r.a.createElement("div",{style:{width:"30%",textAlign:"right"}},r.a.createElement("strong",null,"status: "),t.status)),t.expanded&&r.a.createElement("div",{style:{width:"100%",marginTop:"15px"}},r.a.createElement("strong",null,"Original Text:"),r.a.createElement(_.a,{style:{width:"100%",backgroundColor:"white"}},t.originalText),t.translatedText&&r.a.createElement("div",{style:{width:"100%",marginTop:"15px"}},r.a.createElement("strong",null,"Translated Text:"),r.a.createElement(_.a,{style:{width:"100%",backgroundColor:"white"}},t.translatedText))))),r.a.createElement("div",{style:{width:"20%",textAlign:"center",alignSelf:"flex-start",paddingTop:"20px"}},r.a.createElement(I.a,{style:{whiteSpace:"nowrap"}},r.a.createElement(k.a,{onClick:function(){return i([{id:t.id,uid:t.uid}])},disabled:"pending"!==t.status||t.disabled,bsStyle:"info"},t.disabled?"Checking..":"Update"),r.a.createElement(k.a,{bsStyle:"danger",onClick:function(){return e.deleteJob({id:t.id})}},"Delete"))))})))}}]),t}(n.Component);q.defaultProps={styleOptions:{requesting:"warning",pending:"info",completed:"success",failed:"danger"}};var D=q,A=function(e){function t(e){var a;return Object(h.a)(this,t),(a=Object(m.a)(this,Object(g.a)(t).call(this,e))).addTranslation=function(e){var t=e.jobId,n=e.id,r=e.originalText,s=e.translatedText,i=e.sourceLang,o=e.targetLang,c=e.status,u=e.uid,h=e.timeStamp;a.setState(function(e){return{translations:Object(d.a)({},e.translations,Object(l.a)({},n,{id:n,jobId:t,originalText:r,translatedText:s,sourceLang:i,targetLang:o,status:c,uid:u,timeStamp:h}))}})},a.deleteTranslation=function(e){var t=e.id;a.setState(function(e){return{translations:Object.keys(e.translations).reduce(function(a,n){return n===t?a:Object(d.a)({},a,Object(l.a)({},n,e.translations[n]))},{})}})},a.expandTranslation=function(e){a.setState(function(t){return{translations:Object.keys(t.translations).reduce(function(a,n){return n===e?Object(d.a)({},a,Object(l.a)({},n,Object(d.a)({},t.translations[n],{expanded:!t.translations[n].expanded}))):Object(d.a)({},a,Object(l.a)({},n,t.translations[n]))},{})}})},a.addUid=function(e,t){a.setState(function(a){return{translations:Object.keys(a.translations).reduce(function(n,r){return r===e?Object(d.a)({},n,Object(l.a)({},r,Object(d.a)({},a.translations[r],{uid:t,status:"pending"}))):Object(d.a)({},n,Object(l.a)({},r,a.translations[r]))},{})}})},a.updateTranslation=function(e,t){a.setState(function(a){return{translations:Object.keys(a.translations).reduce(function(n,r){return r===e?Object(d.a)({},n,Object(l.a)({},r,Object(d.a)({},a.translations[r],t))):Object(d.a)({},n,Object(l.a)({},r,a.translations[r]))},{})}})},a.state={translations:{}},a.checkStatus=a.checkStatus.bind(Object(b.a)(Object(b.a)(a))),a}return Object(f.a)(t,e),Object(p.a)(t,[{key:"componentDidMount",value:function(){var e=Object(u.a)(c.a.mark(function e(){var t,a=this;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,O();case 3:(t=e.sent).jobs&&t.jobs instanceof Array&&t.jobs.forEach(function(e){a.addTranslation({id:String(e.id),originalText:e.original_text,translatedText:e.translated_text,sourceLang:e.source_lang,targetLang:e.target_lang,status:e.status,uid:e.uid,timeStamp:1e3*e.timestamp})}),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),this.setState({errorStatus:e.t0.message});case 10:case"end":return e.stop()}},e,this,[[0,7]])}));return function(){return e.apply(this,arguments)}}()},{key:"checkStatus",value:function(){var e=Object(u.a)(c.a.mark(function e(t){var a,n=this;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t.map(function(){var e=Object(u.a)(c.a.mark(function e(t){return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n.updateTranslation(t.id,{disabled:!0}),e.prev=1,e.next=4,T(t);case 4:(a=e.sent)&&n.updateTranslation(t.id,{disabled:!1}),"completed"===a.status&&n.updateTranslation(t.id,{status:"completed",translatedText:a.translatedText}),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(1),n.setState({errorStatus:e.t0.message});case 12:case"end":return e.stop()}},e,this,[[1,9]])}));return function(t){return e.apply(this,arguments)}}());case 1:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this.state.translations;return r.a.createElement("div",{className:"app flex-column"},r.a.createElement(x.a,{className:"title"},r.a.createElement("img",{src:a(135)}),"Translation Service"),r.a.createElement(M,{addUid:this.addUid,addTranslation:this.addTranslation,updateTranslation:this.updateTranslation,checkStatus:this.checkStatus,translations:e}),r.a.createElement(D,{translations:e,expandTranslation:this.expandTranslation,checkStatus:this.checkStatus,deleteTranslation:this.deleteTranslation}))}}]),t}(n.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));i.a.render(r.a.createElement(A,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})},78:function(e,t,a){e.exports=a(136)},83:function(e,t,a){},87:function(e,t,a){}},[[78,2,1]]]);
//# sourceMappingURL=main.ed694c2d.chunk.js.map